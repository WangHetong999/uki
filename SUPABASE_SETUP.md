# Supabase é‚®ç®±ç™»å½•é…ç½®æŒ‡å—

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•ä¸º uki åº”ç”¨é…ç½® Supabase é‚®ç®±ç™»å½•åŠŸèƒ½ã€‚

## ğŸ“‹ ç›®å½•

1. [åˆ›å»º Supabase é¡¹ç›®](#1-åˆ›å»º-supabase-é¡¹ç›®)
2. [é…ç½®è®¤è¯è®¾ç½®](#2-é…ç½®è®¤è¯è®¾ç½®)
3. [è·å– API å¯†é’¥](#3-è·å–-api-å¯†é’¥)
4. [é…ç½® iOS é¡¹ç›®](#4-é…ç½®-ios-é¡¹ç›®)
5. [æµ‹è¯•ç™»å½•åŠŸèƒ½](#5-æµ‹è¯•ç™»å½•åŠŸèƒ½)
6. [å¸¸è§é—®é¢˜](#6-å¸¸è§é—®é¢˜)

---

## 1. åˆ›å»º Supabase é¡¹ç›®

### æ­¥éª¤ 1.1: æ³¨å†Œ Supabase è´¦å·
1. è®¿é—® [https://supabase.com](https://supabase.com)
2. ç‚¹å‡» **Start your project** æˆ– **Sign in**
3. ä½¿ç”¨ GitHub è´¦å·ç™»å½•ï¼ˆæ¨èï¼‰æˆ–åˆ›å»ºæ–°è´¦å·

### æ­¥éª¤ 1.2: åˆ›å»ºæ–°é¡¹ç›®
1. ç™»å½•åï¼Œç‚¹å‡» **New Project**
2. å¡«å†™é¡¹ç›®ä¿¡æ¯ï¼š
   - **Organization**: é€‰æ‹©æˆ–åˆ›å»ºç»„ç»‡
   - **Name**: `uki` æˆ–è‡ªå®šä¹‰åç§°
   - **Database Password**: è®¾ç½®ä¸€ä¸ªå¼ºå¯†ç ï¼ˆä¿å­˜å¥½ï¼‰
   - **Region**: é€‰æ‹© `Northeast Asia (Tokyo)` æˆ–æœ€è¿‘çš„åŒºåŸŸ
3. ç‚¹å‡» **Create new project**
4. ç­‰å¾… 1-2 åˆ†é’Ÿï¼Œé¡¹ç›®åˆå§‹åŒ–å®Œæˆ

---

## 2. é…ç½®è®¤è¯è®¾ç½®

### æ­¥éª¤ 2.1: å¯ç”¨é‚®ç®±ç™»å½•
1. åœ¨é¡¹ç›®æ§åˆ¶å°ï¼Œç‚¹å‡»å·¦ä¾§èœå• **Authentication**
2. ç‚¹å‡» **Providers** æ ‡ç­¾
3. æ‰¾åˆ° **Email** æä¾›å•†
4. ç¡®ä¿ **Email** å¼€å…³æ˜¯æ‰“å¼€çš„ï¼ˆé»˜è®¤å·²å¯ç”¨ï¼‰

### æ­¥éª¤ 2.2: é…ç½®é‚®ç®±éªŒè¯ï¼ˆå¯é€‰ï¼‰
é»˜è®¤æƒ…å†µä¸‹ï¼ŒSupabase è¦æ±‚ç”¨æˆ·éªŒè¯é‚®ç®±ã€‚å¦‚æœä½ æƒ³åœ¨å¼€å‘é˜¶æ®µè·³è¿‡éªŒè¯ï¼š

1. ç‚¹å‡» **Email** æä¾›å•†è¿›å…¥è®¾ç½®
2. æ‰¾åˆ° **Confirm email** é€‰é¡¹
3. å…³é—­ **Confirm email** å¼€å…³ï¼ˆä»…ç”¨äºå¼€å‘ï¼Œç”Ÿäº§ç¯å¢ƒè¯·æ‰“å¼€ï¼‰
4. ç‚¹å‡» **Save** ä¿å­˜è®¾ç½®

> âš ï¸ **æ³¨æ„**: ç”Ÿäº§ç¯å¢ƒå¼ºçƒˆå»ºè®®å¯ç”¨é‚®ç®±éªŒè¯ï¼

### æ­¥éª¤ 2.3: é…ç½®é‡å®šå‘ URLï¼ˆå¯é€‰ï¼‰
1. åœ¨ **Authentication > URL Configuration** ä¸­
2. æ·»åŠ é‡å®šå‘ URLï¼ˆç›®å‰é‚®ç®±ç™»å½•ä¸éœ€è¦ï¼‰
3. é»˜è®¤è®¾ç½®å³å¯

---

## 3. è·å– API å¯†é’¥

### æ­¥éª¤ 3.1: è·å–é¡¹ç›® URL å’Œ API Key
1. åœ¨é¡¹ç›®æ§åˆ¶å°ï¼Œç‚¹å‡»å·¦ä¾§èœå• **Settings**ï¼ˆé½¿è½®å›¾æ ‡ï¼‰
2. ç‚¹å‡» **API** æ ‡ç­¾
3. å¤åˆ¶ä»¥ä¸‹ä¿¡æ¯ï¼š
   - **Project URL**: ç±»ä¼¼ `https://xxxxxxxxxxxxx.supabase.co`
   - **anon public** key: ä»¥ `eyJ` å¼€å¤´çš„é•¿å­—ç¬¦ä¸²

> ğŸ“ **é‡è¦**: ä¿å­˜è¿™ä¸¤ä¸ªå€¼ï¼Œä¸‹ä¸€æ­¥éœ€è¦ç”¨åˆ°ï¼

### ç¤ºä¾‹ï¼š
```
Project URL: https://abcdefghijk.supabase.co
anon key: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6...
```

---

## 4. é…ç½® iOS é¡¹ç›®

### æ­¥éª¤ 4.1: æ·»åŠ  Supabase Swift SDK

1. åœ¨ Xcode ä¸­æ‰“å¼€ `uki.xcodeproj`
2. é€‰æ‹©é¡¹ç›®æ–‡ä»¶ï¼ˆè“è‰²å›¾æ ‡ï¼‰
3. é€‰æ‹© `uki` target
4. ç‚¹å‡» **Package Dependencies** æ ‡ç­¾
5. ç‚¹å‡» `+` æŒ‰é’®
6. è¾“å…¥åŒ… URL:
   ```
   https://github.com/supabase/supabase-swift
   ```
7. ç‚¹å‡» **Add Package**
8. åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œç¡®ä¿é€‰ä¸­ `Supabase`
9. ç‚¹å‡» **Add Package**

### æ­¥éª¤ 4.2: é…ç½® Supabase å¯†é’¥

æ‰“å¼€æ–‡ä»¶ `uki/SupabaseConfig.swift`ï¼Œæ›¿æ¢ä»¥ä¸‹å†…å®¹ï¼š

```swift
struct SupabaseConfig {
    // æ›¿æ¢ä¸ºä½ çš„ Supabase é¡¹ç›® URL
    static let supabaseURL = "https://ä½ çš„é¡¹ç›®id.supabase.co"

    // æ›¿æ¢ä¸ºä½ çš„ Supabase anon key
    static let supabaseAnonKey = "eyJå¼€å¤´çš„å®Œæ•´key..."
}
```

**ç¤ºä¾‹ï¼š**
```swift
struct SupabaseConfig {
    static let supabaseURL = "https://abcdefghijk.supabase.co"
    static let supabaseAnonKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFiY2RlZmdoaWprIiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTk5OTk5OTksImV4cCI6MjAxNTU3NTk5OX0.xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
}
```

### æ­¥éª¤ 4.3: æ£€æŸ¥æ–‡ä»¶ç»“æ„

ç¡®ä¿ä»¥ä¸‹æ–‡ä»¶å·²æ·»åŠ åˆ°é¡¹ç›®ä¸­ï¼š

```
uki/
â”œâ”€â”€ SupabaseConfig.swift      âœ… Supabase é…ç½®
â”œâ”€â”€ AuthService.swift          âœ… è®¤è¯æœåŠ¡
â”œâ”€â”€ LoginView.swift            âœ… ç™»å½•ç•Œé¢
â”œâ”€â”€ RegisterView.swift         âœ… æ³¨å†Œç•Œé¢
â”œâ”€â”€ ukiApp.swift               âœ… å·²ä¿®æ”¹ï¼ˆè®¤è¯çŠ¶æ€ç®¡ç†ï¼‰
â””â”€â”€ SettingsView.swift         âœ… å·²ä¿®æ”¹ï¼ˆé€€å‡ºç™»å½•ï¼‰
```

---

## 5. æµ‹è¯•ç™»å½•åŠŸèƒ½

### æ­¥éª¤ 5.1: æ„å»ºå¹¶è¿è¡Œ

1. åœ¨ Xcode ä¸­ï¼Œé€‰æ‹©æ¨¡æ‹Ÿå™¨ï¼ˆå¦‚ iPhone 15ï¼‰
2. ç‚¹å‡» **Run** æŒ‰é’®ï¼ˆâ–¶ï¸ï¼‰æˆ–æŒ‰ `Cmd + R`
3. åº”ç”¨å¯åŠ¨åï¼Œåº”è¯¥çœ‹åˆ°ç™»å½•ç•Œé¢

### æ­¥éª¤ 5.2: æ³¨å†Œæ–°ç”¨æˆ·

1. ç‚¹å‡» **"ç«‹å³æ³¨å†Œ"** é“¾æ¥
2. è¾“å…¥é‚®ç®±åœ°å€ï¼ˆå¦‚ `test@example.com`ï¼‰
3. è¾“å…¥å¯†ç ï¼ˆè‡³å°‘ 6 ä¸ªå­—ç¬¦ï¼‰
4. ç¡®è®¤å¯†ç 
5. ç‚¹å‡» **"æ³¨å†Œ"** æŒ‰é’®
6. æ³¨å†ŒæˆåŠŸåä¼šè‡ªåŠ¨ç™»å½•å¹¶æ˜¾ç¤ºä¸»ç•Œé¢

### æ­¥éª¤ 5.3: é€€å‡ºç™»å½•

1. åœ¨ä¸»ç•Œé¢ï¼Œç‚¹å‡» **"è®¾ç½®"** æŒ‰é’®
2. æ»šåŠ¨åˆ°åº•éƒ¨
3. ç‚¹å‡» **"é€€å‡ºç™»å½•"** æŒ‰é’®ï¼ˆçº¢è‰²ï¼‰
4. ç¡®è®¤é€€å‡º
5. åº”ç”¨ä¼šè¿”å›ç™»å½•ç•Œé¢

### æ­¥éª¤ 5.4: å†æ¬¡ç™»å½•

1. è¾“å…¥åˆšæ‰æ³¨å†Œçš„é‚®ç®±å’Œå¯†ç 
2. ç‚¹å‡» **"ç™»å½•"** æŒ‰é’®
3. ç™»å½•æˆåŠŸåè¿›å…¥ä¸»ç•Œé¢

---

## 6. å¸¸è§é—®é¢˜

### Q1: ç¼–è¯‘é”™è¯¯ï¼š"No such module 'Supabase'"
**è§£å†³æ–¹æ¡ˆ:**
1. ç¡®ä¿å·²æ­£ç¡®æ·»åŠ  Supabase Swift SDKï¼ˆè§æ­¥éª¤ 4.1ï¼‰
2. æ¸…ç†æ„å»ºç¼“å­˜ï¼š`Cmd + Shift + K`
3. é‡æ–°æ„å»ºï¼š`Cmd + B`

### Q2: ç™»å½•æ—¶æŠ¥é”™ï¼š"Invalid URL"
**è§£å†³æ–¹æ¡ˆ:**
- æ£€æŸ¥ `SupabaseConfig.swift` ä¸­çš„ `supabaseURL` æ˜¯å¦æ­£ç¡®
- URL å¿…é¡»ä»¥ `https://` å¼€å¤´
- URL æ ¼å¼ï¼š`https://é¡¹ç›®id.supabase.co`

### Q3: æ³¨å†Œæ—¶æŠ¥é”™ï¼š"é‚®ç®±å·²è¢«æ³¨å†Œ"
**è§£å†³æ–¹æ¡ˆ:**
- è¯¥é‚®ç®±å·²ç»æ³¨å†Œè¿‡ï¼Œè¯·ç›´æ¥ç™»å½•
- æˆ–è€…åœ¨ Supabase æ§åˆ¶å°åˆ é™¤è¯¥ç”¨æˆ·ï¼š
  1. Authentication > Users
  2. æ‰¾åˆ°è¯¥ç”¨æˆ·å¹¶ç‚¹å‡»åˆ é™¤

### Q4: ç™»å½•æˆåŠŸä½†æ˜¾ç¤º"æœªç™»å½•"
**è§£å†³æ–¹æ¡ˆ:**
- æ£€æŸ¥ `AuthService.swift` ä¸­çš„ `checkAuthStatus()` æ–¹æ³•
- ç¡®ä¿ `ukiApp.swift` æ­£ç¡®ç›‘å¬ `authService.isAuthenticated`
- é‡å¯åº”ç”¨

### Q5: å¦‚ä½•åœ¨ Supabase æ§åˆ¶å°æŸ¥çœ‹ç”¨æˆ·ï¼Ÿ
**è§£å†³æ–¹æ¡ˆ:**
1. ç™»å½• Supabase æ§åˆ¶å°
2. é€‰æ‹©é¡¹ç›®
3. ç‚¹å‡» **Authentication** > **Users**
4. å¯ä»¥çœ‹åˆ°æ‰€æœ‰æ³¨å†Œç”¨æˆ·

### Q6: å¦‚ä½•é‡ç½®ç”¨æˆ·å¯†ç ï¼Ÿ
**å½“å‰å®ç°:**
- ç›®å‰æ²¡æœ‰å®ç°å¯†ç é‡ç½®åŠŸèƒ½
- ç”¨æˆ·éœ€è¦ä½¿ç”¨ Supabase æ§åˆ¶å°æ‰‹åŠ¨é‡ç½®
- æˆ–è€…åˆ é™¤ç”¨æˆ·åé‡æ–°æ³¨å†Œ

**æœªæ¥æ”¹è¿›:**
å¯ä»¥æ·»åŠ  "å¿˜è®°å¯†ç " åŠŸèƒ½ï¼Œä½¿ç”¨ Supabase çš„å¯†ç é‡ç½® APIï¼š
```swift
try await client.auth.resetPasswordForEmail(email)
```

---

## ğŸ‰ å®Œæˆï¼

ç°åœ¨ä½ çš„ uki åº”ç”¨å·²ç»å…·å¤‡å®Œæ•´çš„é‚®ç®±ç™»å½•åŠŸèƒ½ï¼š

âœ… ç”¨æˆ·æ³¨å†Œ
âœ… ç”¨æˆ·ç™»å½•
âœ… é€€å‡ºç™»å½•
âœ… è®¤è¯çŠ¶æ€ç®¡ç†
âœ… æŒä¹…åŒ–ä¼šè¯ï¼ˆè‡ªåŠ¨ç™»å½•ï¼‰

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Supabase å®˜æ–¹æ–‡æ¡£](https://supabase.com/docs)
- [Supabase Swift SDK](https://github.com/supabase/supabase-swift)
- [Supabase Auth API](https://supabase.com/docs/guides/auth)

---

## ğŸ” å®‰å…¨å»ºè®®

âš ï¸ **ç”Ÿäº§ç¯å¢ƒæ³¨æ„äº‹é¡¹:**

1. **å¯ç”¨é‚®ç®±éªŒè¯**: é˜²æ­¢æ¶æ„æ³¨å†Œ
2. **é…ç½®é€Ÿç‡é™åˆ¶**: é˜²æ­¢æš´åŠ›ç ´è§£
3. **ä½¿ç”¨ç¯å¢ƒå˜é‡**: ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç  API å¯†é’¥
4. **å¯ç”¨ Row Level Security (RLS)**: ä¿æŠ¤æ•°æ®åº“å®‰å…¨
5. **å®šæœŸæ›´æ–°å¯†é’¥**: å®šæœŸè½®æ¢ API å¯†é’¥

---

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ [Supabase ç¤¾åŒºè®ºå›](https://github.com/supabase/supabase/discussions) æˆ–æäº¤ Issueã€‚
